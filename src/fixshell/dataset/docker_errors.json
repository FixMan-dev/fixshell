[
  {
    "error_pattern": "docker: command not found|docker: not found",
    "category": "docker_not_installed",
    "type": "RECOVERABLE",
    "scope": "RESOURCE",
    "recommended_checks": [
      "which docker",
      "ls /usr/bin/docker"
    ],
    "suggested_fix": [
      "Docker is not installed on this system. FixShell can guide you through a distro-specific installation."
    ],
    "severity": "high"
  },
  {
    "error_pattern": "permission denied while trying to connect to the Docker daemon socket",
    "category": "docker_daemon_permission",
    "type": "RECOVERABLE",
    "scope": "PERMISSION",
    "recommended_checks": [
      "ls -l /var/run/docker.sock",
      "groups"
    ],
    "suggested_fix": [
      "Add user to docker group: 'sudo usermod -aG docker $USER'"
    ],
    "fix_commands": [
      [
        "sudo",
        "usermod",
        "-aG",
        "docker",
        "$USER"
      ]
    ],
    "severity": "high"
  },
  {
    "error_pattern": "Cannot connect to the Docker daemon at .* Is the docker daemon running?",
    "category": "docker_daemon_service",
    "type": "RECOVERABLE",
    "scope": "SERVICE",
    "recommended_checks": [
      "systemctl status docker"
    ],
    "suggested_fix": [
      "Start Docker service: 'sudo systemctl start docker'"
    ],
    "fix_commands": [
      [
        "sudo",
        "systemctl",
        "start",
        "docker"
      ]
    ],
    "severity": "high"
  },
  {
    "error_pattern": "Conflict. The container name \"(.*)\" is already in use",
    "category": "docker_name_conflict",
    "type": "RECOVERABLE",
    "scope": "CONFLICT",
    "recommended_checks": [
      "docker ps -a"
    ],
    "suggested_fix": [
      "Remove existing container before running"
    ],
    "fix_commands": [
      [
        "docker",
        "rm",
        "-f",
        "{MATCH_1}"
      ]
    ],
    "severity": "medium"
  },
  {
    "error_pattern": "not signed|InRelease is not signed",
    "category": "docker_unsigned_repo",
    "type": "RECOVERABLE",
    "scope": "SECURITY",
    "suggested_fix": [
      "The repository is not signed or the signature is invalid. Check GPG setup."
    ],
    "severity": "high"
  },
  {
    "error_pattern": "signatures couldn't be verified|NO_PUBKEY",
    "category": "docker_gpg_failure",
    "type": "RECOVERABLE",
    "scope": "SECURITY",
    "suggested_fix": [
      "GPG signature verification failed. The Docker public key might be missing or compromised."
    ],
    "severity": "high"
  },
  {
    "error_pattern": "404  Not Found|hash mismatch|Failed to fetch",
    "category": "docker_codename_mismatch",
    "type": "RECOVERABLE",
    "scope": "DETECTION",
    "suggested_fix": [
      "Repository mismatch detected. The Ubuntu codename might be incorrect or unsupported."
    ],
    "severity": "high"
  }
]